<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Mon Album Pok√©mon Live</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { background: #1a1a1a; color: white; font-family: 'Segoe UI', sans-serif; text-align: center; }
        .grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 20px; }
        .card-container { width: 140px; position: relative; }
        .card-img { 
            width: 100%; border-radius: 8px; border: 2px solid #333;
            filter: grayscale(100%) brightness(30%); transition: 0.3s;
        }
        .owned .card-img { filter: grayscale(0%) brightness(100%); border-color: gold; }
        .badge { 
            position: absolute; bottom: 5px; right: 5px; background: red; 
            color: white; border-radius: 50%; width: 25px; height: 25px; 
            display: none; align-items: center; justify-content: center; font-weight: bold;
        }
        .owned .badge { display: flex; }
        input { padding: 10px; border-radius: 5px; border: none; width: 200px; }
        button { padding: 10px; border-radius: 5px; background: gold; border: none; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Ma Collection de Cartes</h1>
    <input type="text" id="pseudo" placeholder="Ton pseudo Twitch...">
    <button onclick="chargerAlbum()">Voir mon album</button>
    <div id="stats"></div>
    <div class="grid" id="album"></div>

    <script>
        // --- CONFIGURATION ---
        // 1. Va sur ton Google Sheet -> Fichier -> Partager -> Publier sur le web
        // 2. Choisis l'onglet "Inventaire" (celui avec toutes les lignes) et format "CSV"
        // 3. Colle le lien ici :
        const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR47QWdhzcXoGqyJc0_OIPnLvPMmeGAofr2RpB-MfvT-7F3rG0ATQ4O5KUtI0u2GkDHV5tTsGfHmC_3/pub?gid=0&single=true&output=csv"; 
        const TOTAL_CARTES = 50;

        function chargerAlbum() {
            const user = document.getElementById('pseudo').value.toLowerCase().trim();
            const grid = document.getElementById('album');
            grid.innerHTML = "Chargement...";

            Papa.parse(CSV_URL, {
                download: true,
                header: true,
                complete: function(results) {
                    const data = results.data;
                    const inv = {};
                    let uniques = 0;

                    // On compte les cartes pour ce pseudo
                    data.forEach(row => {
                        if(row.Pseudo && row.Pseudo.toLowerCase() === user) {
                            inv[row.ID_Carte] = (inv[row.ID_Carte] || 0) + 1;
                        }
                    });

                    grid.innerHTML = "";
                    for(let i=1; i<=TOTAL_CARTES; i++) {
                        const count = inv[i] || 0;
                        const has = count > 0;
                        if(has) uniques++;

                        const div = document.createElement('div');
                        div.className = "card-container" + (has ? " owned" : "");
                        div.innerHTML = `
                            <img src="img/${i}.png" class="card-img">
                            <div class="badge">x${count}</div>
                        `;
                        grid.appendChild(div);
                    }
                    document.getElementById('stats').innerText = `Collection : ${uniques} / ${TOTAL_CARTES}`;
                }
            });
        }
    </script>
</body>
</html>